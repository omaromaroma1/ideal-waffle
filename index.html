<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Money Budgeter</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: white;
    color: black;
    margin: 0;
    padding: 0;
    text-align: center;
  }
  body.dark-mode {
    background-color: #121212;
    color: white;
  }
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background-color: #007bff;
    color: white;
  }
  header h1 {
    margin: 0;
    font-size: 1.5rem;
  }
  #budget {
    font-size: 1.8rem; /* slightly bigger */
    font-weight: bold; /* bold */
    margin: 15px 0;
  }
  .buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin-bottom: 20px;
  }
  .buttons button {
    padding: 10px 15px;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    background-color: #007bff;
    color: white;
    cursor: pointer;
  }
  .buttons button:hover {
    background-color: #0056b3;
  }
  #history {
    max-height: 150px;
    overflow-y: auto;
    background: rgba(0,0,0,0.05);
    padding: 10px;
    border-radius: 8px;
    margin: 10px;
  }
  body.dark-mode #history {
    background: rgba(255,255,255,0.1);
  }
  /* Modal styling */
  .modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  }
  .modal-content {
    background: white;
    padding: 20px;
    border-radius: 10px;
    width: 90%;
    max-width: 400px;
    text-align: left;
  }
  body.dark-mode .modal-content {
    background: #333;
    color: white;
  }
  .modal-content button {
    margin-top: 10px;
  }
</style>
</head>
<body>
<header>
  <h1>Money Budgeter</h1>
  <button id="themeToggle">üåô</button>
</header>

<div id="budget">$0.00</div>

<div class="buttons">
  <button onclick="addAmount()">Add</button>
  <button onclick="subtractAmount()">Subtract</button>
  <button onclick="clearHistory()">Clear History</button>
  <button onclick="resetBudget()">Reset</button>
  <button onclick="window.location.href='repeat.html'">Repeat ‚ûï</button>
  <button onclick="viewCategories()">üìä View Categories</button>
</div>

<div id="history"></div>

<!-- Modal -->
<div id="modal" class="modal" style="display:none;">
  <div class="modal-content" id="modalContent"></div>
</div>

<script>
let budget = parseFloat(localStorage.getItem('budget')) || 0;
let historyData = JSON.parse(localStorage.getItem('history')) || [];
let categories = JSON.parse(localStorage.getItem('categories')) || {
  Leisure: 0,
  Transportation: 0,
  Food: 0,
  Groceries: 0,
  Others: 0,
  Games: 0,
  Friends: 0
};

function updateBudgetDisplay() {
  document.getElementById('budget').textContent = `$${budget.toFixed(2)}`;
  localStorage.setItem('budget', budget);
}

function saveHistory() {
  localStorage.setItem('history', JSON.stringify(historyData));
}

function addAmount() {
  let amount = parseFloat(prompt("Enter amount to add:"));
  if (!isNaN(amount)) {
    budget += amount;
    historyData.push(`${new Date().toLocaleString()} ‚Äî Add: $${amount.toFixed(2)}`);
    saveHistory();
    updateBudgetDisplay();
    renderHistory();
  }
}

function subtractAmount() {
  const modal = document.getElementById('modal');
  const content = document.getElementById('modalContent');
  content.innerHTML = `<h3>Select Category</h3>`;
  Object.keys(categories).forEach(cat => {
    let btn = document.createElement('button');
    btn.textContent = cat;
    btn.onclick = () => {
      let amount = parseFloat(prompt(`Enter amount to subtract from ${cat}:`));
      if (!isNaN(amount)) {
        budget -= amount;
        categories[cat] += amount;
        localStorage.setItem('categories', JSON.stringify(categories));
        historyData.push(`${new Date().toLocaleString()} ‚Äî Subtract (${cat}): $${amount.toFixed(2)}`);
        saveHistory();
        updateBudgetDisplay();
        renderHistory();
      }
      modal.style.display = 'none';
    };
    content.appendChild(btn);
  });
  let closeBtn = document.createElement('button');
  closeBtn.textContent = "Close";
  closeBtn.onclick = () => modal.style.display = 'none';
  content.appendChild(closeBtn);
  modal.style.display = 'flex';
}

function viewCategories() {
  const modal = document.getElementById('modal');
  const content = document.getElementById('modalContent');
  content.innerHTML = `<h3>Category Totals</h3>` + 
    Object.entries(categories).map(([cat, val]) => `${cat}: $${val.toFixed(2)}`).join('<br>');
  let closeBtn = document.createElement('button');
  closeBtn.textContent = "Close";
  closeBtn.onclick = () => modal.style.display = 'none';
  content.appendChild(closeBtn);
  modal.style.display = 'flex';
}

function clearHistory() {
  if (confirm("Clear history?")) {
    historyData = [];
    categories = { Leisure: 0, Transportation: 0, Food: 0, Groceries: 0, Others: 0, Games: 0, Friends: 0 };
    saveHistory();
    localStorage.setItem('categories', JSON.stringify(categories));
    renderHistory();
  }
}

function resetBudget() {
  if (confirm("Reset budget?")) {
    budget = 0;
    updateBudgetDisplay();
  }
}

function renderHistory() {
  const historyEl = document.getElementById('history');
  historyEl.innerHTML = historyData.map(item => `<div>${item}</div>`).join('');
}

document.getElementById('themeToggle').onclick = () => {
  document.body.classList.toggle('dark-mode');
  localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
  document.getElementById('themeToggle').textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è' : 'üåô';
};

if (localStorage.getItem('theme') === 'dark') {
  document.body.classList.add('dark-mode');
  document.getElementById('themeToggle').textContent = '‚òÄÔ∏è';
}

updateBudgetDisplay();
renderHistory();
</script>
</body>
</html>
