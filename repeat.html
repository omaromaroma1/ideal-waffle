<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Repeating Transactions</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f0f2f5;
      color: #333;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 500px;
      margin: 30px auto;
      background: #fff;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    #clock {
      font-size: 1em;
      font-weight: bold;
    }

    .back-button {
      background: none;
      border: none;
      font-size: 18px;
      color: #007bff;
      cursor: pointer;
      font-weight: bold;
      padding: 0;
    }

    h1 {
      margin-top: 0;
      font-size: 22px;
      text-align: center;
      color: #007bff;
    }

    label {
      font-weight: 600;
      display: block;
      margin-top: 20px;
      margin-bottom: 6px;
    }

    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 10px;
      box-sizing: border-box;
      font-size: 16px;
    }

    .days, .months {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .days label, .months label {
      flex: 1 1 28%;
      text-align: center;
      background: #f8f9fa;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      cursor: pointer;
      font-size: 15px;
      transition: background 0.2s, border 0.2s;
    }

    .days input[type="checkbox"], .months input[type="checkbox"] {
      display: none;
    }

    .days input[type="checkbox"]:checked + span,
    .months input[type="checkbox"]:checked + span {
      background-color: #007bff;
      color: white;
      border-radius: 8px;
      padding: 4px 8px;
    }

    .repeat-entry {
      border: 1px dashed #ccc;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
    }

    button {
      margin-top: 20px;
      padding: 14px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: bold;
      width: 100%;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="top-bar">
      <button class="back-button" onclick="goBack()">‚Üê Back</button>
      <div id="clock">üïí Time: --:--</div>
    </div>

    <h1>Repeating Transactions</h1>

    <div id="repeat-list"></div>

    <button onclick="addEntry()">+ Add Another</button>
    <button onclick="saveRepeat()">Save All</button>
  </div>

  <script>
    function updateClock() {
      const now = new Date();
      document.getElementById('clock').textContent =
        `üïí Time: ${now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true })}`;
    }

    function goBack() {
      window.location.href = "index.html";
    }

    function addEntry() {
      const container = document.createElement('div');
      container.className = 'repeat-entry';
      container.innerHTML = `
        <label>Amount</label>
        <input type="number" class="amount" placeholder="Enter amount" />

        <label>Type</label>
        <select class="type">
          <option value="add">Add</option>
          <option value="subtract">Subtract</option>
        </select>

        <label>Repeat on Days</label>
        <div class="days">
          ${['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(day => 
            `<label><input type="checkbox" value="${day}" /><span>${day}</span></label>`).join('')}
        </div>

        <label>Repeat in Months</label>
        <div class="months">
          ${['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'].map(mon => 
            `<label><input type="checkbox" value="${mon}" /><span>${mon}</span></label>`).join('')}
        </div>

        <label>Time</label>
        <input type="time" class="time" />
      `;
      document.getElementById('repeat-list').appendChild(container);
    }

    function saveRepeat() {
      const entries = document.querySelectorAll('.repeat-entry');
      const data = [];

      entries.forEach(entry => {
        const amount = parseFloat(entry.querySelector('.amount').value);
        const type = entry.querySelector('.type').value;
        const days = Array.from(entry.querySelectorAll('.days input:checked')).map(cb => cb.value);
        const months = Array.from(entry.querySelectorAll('.months input:checked')).map(cb => cb.value);
        const time = entry.querySelector('.time').value;

        if (!isNaN(amount) && time) {
          data.push({
            amount: type === 'subtract' ? -amount : amount,
            days,
            months,
            time
          });
        }
      });

      localStorage.setItem('repeatingTransactions', JSON.stringify(data));
      alert("Saved! Returning to main page.");
      window.location.href = "index.html";
    }

    updateClock();
    setInterval(updateClock, 1000);
    addEntry(); // Start with one
  </script>
</body>
</html>
